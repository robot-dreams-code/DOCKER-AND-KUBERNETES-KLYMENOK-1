


# adding Bitnami repo and updating repo list 
PS C:\Users\username> helm repo add bitnami https://charts.bitnami.com/bitnami
"bitnami" has been added to your repositories

PS C:\Users\username> helm repo update
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "bitnami" chart repository
Update Complete. ⎈Happy Helming!⎈


#installing redis with desired for working with python-app options
# helm install redis-lesson11 bitnami/redis \
#   --namespace krotovhh \
#   --create-namespace \
#   --set architecture=standalone \
#   --set fullnameOverride=redis-lesson11 \
#   --set master.persistence.enabled=true \
#   --set master.persistence.size=1Gi \
#   --set master.persistence.accessModes[0]=ReadWriteOnce \
#   --set auth.enabled=false

PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> helm install redis-lesson11 bitnami/redis --namespace krotovhh --create-namespace --set architecture=standalone --set fullnameOverride=redis-lesson11 --set master.persistence.enabled=true --set master.persistence.size=1Gi --set master.persistence.accessModes[0]=ReadWriteOnce --set auth.enabled=false
level=WARN msg="unable to find exact version; falling back to closest available version" chart=redis requested="" selected=24.0.7
NAME: redis-lesson11
LAST DEPLOYED: Fri Dec 12 22:28:35 2025
NAMESPACE: krotovhh
STATUS: deployed
REVISION: 1
DESCRIPTION: Install complete
TEST SUITE: None
NOTES:
CHART NAME: redis
CHART VERSION: 24.0.7
APP VERSION: 8.4.0

⚠ WARNING: Since August 28th, 2025, only a limited subset of images/charts are available for free.
    Subscribe to Bitnami Secure Images to receive continued support and security updates.
    More info at https://bitnami.com and https://github.com/bitnami/containers/issues/83267

** Please be patient while the chart is being deployed **

Redis&reg; can be accessed via port 6379 on the following DNS name from within your cluster:

    redis-lesson11-master.krotovhh.svc.cluster.local



To connect to your Redis&reg; server:

1. Run a Redis&reg; pod that you can use as a client:

   kubectl run --namespace krotovhh redis-client --restart='Never'  --image registry-1.docker.io/bitnami/redis:latest --command -- sleep infinity

   Use the following command to attach to the pod:

   kubectl exec --tty -i redis-client \
   --namespace krotovhh -- bash

2. Connect using the Redis&reg; CLI:
   redis-cli -h redis-lesson11-master

To connect to your database from outside the cluster execute the following commands:

    kubectl port-forward --namespace krotovhh svc/redis-lesson11-master 6379:6379 &
    redis-cli -h 127.0.0.1 -p 6379
WARNING: Rolling tag detected (bitnami/redis:latest), please note that it is strongly recommended to avoid using rolling tags in a production environment.
+info https://techdocs.broadcom.com/us/en/vmware-tanzu/application-catalog/tanzu-application-catalog/services/tac-doc/apps-tutorials-understand-rolling-tags-containers-index.html
WARNING: Rolling tag detected (bitnami/redis-sentinel:latest), please note that it is strongly recommended to avoid using rolling tags in a production environment.
+info https://techdocs.broadcom.com/us/en/vmware-tanzu/application-catalog/tanzu-application-catalog/services/tac-doc/apps-tutorials-understand-rolling-tags-containers-index.html
WARNING: Rolling tag detected (bitnami/redis-exporter:latest), please note that it is strongly recommended to avoid using rolling tags in a production environment.
+info https://techdocs.broadcom.com/us/en/vmware-tanzu/application-catalog/tanzu-application-catalog/services/tac-doc/apps-tutorials-understand-rolling-tags-containers-index.html
WARNING: Rolling tag detected (bitnami/os-shell:latest), please note that it is strongly recommended to avoid using rolling tags in a production environment.
+info https://techdocs.broadcom.com/us/en/vmware-tanzu/application-catalog/tanzu-application-catalog/services/tac-doc/apps-tutorials-understand-rolling-tags-containers-index.html
WARNING: Rolling tag detected (bitnami/os-shell:latest), please note that it is strongly recommended to avoid using rolling tags in a production environment.
+info https://techdocs.broadcom.com/us/en/vmware-tanzu/application-catalog/tanzu-application-catalog/services/tac-doc/apps-tutorials-understand-rolling-tags-containers-index.html

WARNING: There are "resources" sections in the chart not set. Using "resourcesPreset" is not recommended for production. For production installations, please set the following values according to your workload needs:
  - replica.resources
  - master.resources
+info https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/ 


# after preparing all the config data for helm release of python-app, checking for errors 
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> helm lint .
==> Linting .
[INFO] Chart.yaml: icon is recommended

1 chart(s) linted, 0 chart(s) failed

# seems like its all good 
# starting to deploy
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> helm install python-app .
NAME: python-app
LAST DEPLOYED: Fri Dec 12 22:50:27 2025
NAMESPACE: default
STATUS: deployed
REVISION: 1
DESCRIPTION: Install complete
TEST SUITE: None

# actually there were a few typos like ClusterIp instead of ClusterIP, but lint did not spotted them idk why 
# checking for redis param inside the pod
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl exec -n krotovhh -it python-course-app-lesson11-deployment-b4cd8b69d-c2h5w -- /bin/bash
root@python-course-app-lesson11-deployment-b4cd8b69d-c2h5w:/app# printenv | grep APP_REDIS
APP_REDIS_URL=redis://redis-lesson11-master:6379

# app deployed successfully and reachable on ingress host (image of availability can be found near this .ini file)

# checking for stable running of new redis (the one with lesson11 in the name) and python-course-app-lesson11 
# both runs without restarts 
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get po -n krotovhh
NAME                                                     READY   STATUS    RESTARTS       AGE
python-course-app-lesson10-deployment-74c9764c56-lvksl   1/1     Running   6 (105m ago)   6d1h
python-course-app-lesson11-deployment-b4cd8b69d-c2h5w    1/1     Running   0              13m
redis-lesson11-master-0                                  1/1     Running   0              35m
redis7-statefulset-0                                     1/1     Running   3 (106m ago)   6d1h

# app deployed as a deployemnt, redis as a statefulset
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get deploy -n krotovhh
NAME                                    READY   UP-TO-DATE   AVAILABLE   AGE
python-course-app-lesson10-deployment   1/1     1            1           6d1h
python-course-app-lesson11-deployment   1/1     1            1           18m

PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get statefulset -n krotovhh
NAME                    READY   AGE
redis-lesson11-master   1/1     40m
redis7-statefulset      1/1     6d1h

# redis have volumeClaimTemplates in statefullset configuration, so each pod will have it own 1Gi of storage on the node  
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get pv -n krotovhh
NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                         STORAGECLASS   VOLUMEATTRIBUTESCLASS   REASON   AGE
pvc-776e39e5-0077-494e-886a-7ad7a8353020   1Gi        RWO            Delete           Bound    default/redis-data-redis-lesson11-master-0    local-path     <unset>                          43m

PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get pvc -n krotovhh
NAME                                 STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
redis-data-redis-lesson11-master-0   Bound    pvc-9e9f486e-c47c-4617-bb68-d26cdf0fef9d   1Gi        RWO            local-path     <unset>                 41m

# redis and python-app also reacheable by ClusterIP for in-cluster communication 
PS C:\Users\username\Documents\repos\DOCKER-AND-KUBERNETES-KLYMENOK-1\homeworks\krotov\module-03\lesson-11\k8s\helm> kubectl get svc -n krotovhh
NAME                                 TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
python-course-app-lesson11-service   ClusterIP   10.43.225.103   <none>        8080/TCP   20m
redis-lesson11-headless              ClusterIP   None            <none>        6379/TCP   42m
redis-lesson11-master                ClusterIP   10.43.103.62    <none>        6379/TCP   42m
